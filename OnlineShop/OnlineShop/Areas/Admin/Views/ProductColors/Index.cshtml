@model IEnumerable<Model.EF.ProductColor>
@using Model.EF;
@{
    OnlineShopDbContext db = new OnlineShopDbContext();
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AdminLTE 2 | Data Tables</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="~/Content/Admin/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- DataTables -->
    <link rel="stylesheet" href="~/Content/Admin/plugins/datatables/dataTables.bootstrap.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="~/Content/Admin/dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="~/Content/Admin/dist/css/skins/_all-skins.min.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        @RenderPage("~/Areas/Admin/Views/Shared/LeftContentUpdate.cshtml")
        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1>
                    Quản Lý Màu
                </h1>
                @*<ol class="breadcrumb">
                        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
                        <li><a href="#">Tables</a></li>
                        <li class="active">Data tables</li>
                    </ol>*@
            </section>
            <!-- Main content -->
            <section class="content">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="box">
                            <div class="box-header">
                                <h3 class="box-title">Data Table With Full Features</h3>
                            </div><!-- /.box-header -->
                            <div class="box-header"><h3>@Html.ActionLink("Thêm mới", "Create")</h3></div>
                            <div class="box-body">
                                <table id="example1" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>Product</th>
                                            <th>Color</th>
                                            <th>Status</th>
                                            <th>#</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in Model)
                                           {
                                            <tr>
                                                <td>@db.Products.Where(z => z.ID == @item.ProductID).FirstOrDefault().Name</td>
                                                <td>@db.Colors.Where(x => x.ID == @item.ColorID).FirstOrDefault().Name</td>
                                                <td>@item.Status</td>
                                                <td id="row_@item.ProductID@item.ColorID" style="text-align:center">
                                                    @Html.ActionLink("Edit", "Edit", new { ProductID = item.ProductID, ColorID = item.ColorID }) |
                                                    <a href="#" class="delete" data-id="@item.ProductID" data-id2="@item.ColorID"><span style="color: red">Delete</span></a>
                                                    @*@Html.ActionLink("Delete", "Delete", new { ID = item.ID }, new { @class = "btn btn-block btn-outline-danger btn-sm" })*@
                                                    @*@Ajax.ActionLink("Delete", "Delete", new { @ProductID = @item.ProductID, @ColorID = @item.ColorID, @class = "btn btn-block btn-outline-danger btn-sm" }, new AjaxOptions
                                                   {
                                                       Confirm = "Bạn có muốn xóa bản ghi này?",
                                                       OnComplete = "$(#row_" + @item.ProductID + @item.ColorID + "),remove()",
                                                       HttpMethod = "Delete"
                                                   })*@
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Product</th>
                                            <th>Color</th>
                                            <th>Status</th>
                                            <th>#</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div><!-- /.box-body -->
                        </div><!-- /.box -->
                    </div><!-- /.col -->
                </div><!-- /.row -->
            </section><!-- /.content -->
        </div><!-- /.content-wrapper -->
        @RenderPage("~/Areas/Admin/Views/Shared/FooterContent.cshtml")
        <!-- Add the sidebar's background. This div must be placed
             immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>
    </div><!-- ./wrapper -->
    <!-- jQuery 2.1.4 -->
    <script src="~/Content/Admin/plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="~/Content/Admin/bootstrap/js/bootstrap.min.js"></script>
    <!-- DataTables -->
    <script src="~/Content/Admin/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/Content/Admin/plugins/datatables/dataTables.bootstrap.min.js"></script>
    <!-- SlimScroll -->
    <script src="~/Content/Admin/plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="~/Content/Admin/plugins/fastclick/fastclick.min.js"></script>
    <!-- AdminLTE App -->
    <script src="~/Content/Admin/dist/js/app.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="~/Content/Admin/dist/js/demo.js"></script>
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <!-- page script -->
    <script>
      $(function () {
        $("#example1").DataTable();
        $('#example2').DataTable({
          "paging": true,
          "lengthChange": false,
          "searching": false,
          "ordering": true,
          "info": true,
          "autoWidth": false
        });
      });
    </script>
    <script>
        $(document).ready(function () {
            $('.delete').click(function (e) {
                e.preventDefault();
                var result = confirm("Bạn có chắc sẽ xóa bản ghi này?");
                    if (result) {
                        var btn = $(this);
                        var id = btn.data('id');
                        var id2 = btn.data('id2');
                        $.ajax({
                            url: "/Admin/ProductColors/Delete",
                            data: { ProductID: id, ColorID : id2},
                            dataType: "json",
                            type: "POST",
                            success: function (data) {
                                if (data.data == false) {
                                    alert("Không thể xóa");
                                    return;
                                }
                                alert("Xóa thành công");
                                location.reload("/Admin/ProductColors/Index");
                            }
                        })
                    }
            })
        })
    </script>
</body>
</html>



